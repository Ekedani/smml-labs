library("dplyr")
result <- NEI %>% group_by(year) %>% summarize(total_emissions = sum(Emissions))
print(result)
result <- NEI %>% group_by(year) %>% summarize(Emissions = sum(Emissions))
plot(result$year, result$Emissions,
type = "b",
main = "Total PM2.5 Emissions by Year",
xlab = "Year",
ylab = "Total PM2.5 Emissions")
View(result)
result <- NEI %>% group_by(year) %>% summarize(Emissions = sum(Emissions))
library("dplyr")
library("dplyr")
NEI <- readRDS("summarySCC_PM25.rds")
SCC <- readRDS("Source_Classification_Code.rds")
result <- NEI %>% group_by(year) %>% summarize(Emissions = sum(Emissions))
plot(result$year, result$Emissions,
type = "b",
main = "Total PM2.5 Emissions by Year",
xlab = "Year",
ylab = "Total PM2.5 Emissions")
result <- NEI %>% group_by(year) %>% summarize(Emissions = sum(Emissions))
plot(result$year, result$Emissions,
type = "b",
main = "Total PM2.5 Emissions by Year",
xlab = "Year",
ylab = "Total PM2.5 Emissions")
result <- NEI %>% group_by(year) %>% summarize(Emissions = sum(Emissions))
plot(result$year, result$Emissions,
type = "b",
main = "Total PM2.5 Emissions by Year",
xlab = "Year",
ylab = "Total PM2.5 Emissions")
View(result)
result <- NEI %>% group_by(year) %>% filter(fips == "24510") %>% summarize(Emissions = sum(Emissions))
View(result)
result <- NEI %>% group_by(year) %>% filter(fips == "24510") %>% summarize(Emissions = sum(Emissions))
plot(result$year, result$Emissions,
type = "b",
main = "Total PM2.5 Emissions in Baltimore by Year",
xlab = "Year",
ylab = "Total PM2.5 Emissions in Baltimore")
q3_result <- NEI %>% group_by(year) %>% filter(fips == "24510") %>% summarize(Emissions = sum(Emissions))
plot(q3_result$year, q3_result$Emissions,
type = "b",
main = "Total PM2.5 Emissions in Baltimore by Year",
xlab = "Year",
ylab = "Total PM2.5 Emissions in Baltimore")
q2_result <- NEI %>% group_by(year) %>% summarize(Emissions = sum(Emissions))
plot(q2_result$year, q2_result$Emissions,
type = "b",
main = "Total PM2.5 Emissions by Year",
xlab = "Year",
ylab = "Total PM2.5 Emissions")
View(SCC)
View(result)
View(q3_result)
View(q2_result)
View(NEI)
View(SCC)
View(result)
View(NEI)
View(NEI)
q3_result <- NEI %>% group_by(year, type) %>% filter(fips == "24510") %>% summarize(Emissions = sum(Emissions))
View(q3_result)
q3_result <- NEI %>% filter(fips == "24510") %>% group_by(year, type) %>% summarize(Emissions = sum(Emissions))
q3_result <- NEI %>% filter(fips == "24510") %>% group_by(year, type) %>% summarize(Emissions = sum(Emissions))
View(SCC)
View(SCC)
View(SCC)
coal_sources <- SCC %>% filter(grepl("coal", Short.Name)) %>% select(SCC)
View(coal_sources)
View(NEI)
View(SCC)
coal_sources <- SCC %>% filter(grepl("coal", Short.Name, , ignore.case = TRUE)) %>% select(SCC)
View(coal_sources)
View(SCC)
View(coal_sources)
coal_sources <- SCC %>% filter(grepl("coal", Short.Name, , ignore.case = TRUE)) %>% select(SCC)
q4_result <- NEI %>% filter(SCC %in% coal_sources$SCC) %>% group_by(year) %>% summarize(Emissions = sum(Emissions))
View(q4_result)
vehicle_sources <- SCC %>% filter(grepl("vehicle", Short.Name, , ignore.case = TRUE)) %>% select(SCC)
coal_sources <- SCC %>% filter(grepl("coal", Short.Name, ignore.case = TRUE)) %>% select(SCC)
q4_result <- NEI %>% filter(SCC %in% coal_sources$SCC) %>% group_by(year) %>% summarize(Emissions = sum(Emissions))
vehicle_sources <- SCC %>% filter(grepl("vehicle", Short.Name, ignore.case = TRUE)) %>% select(SCC)
vehicle_sources <- SCC %>% filter(grepl("vehicle", Short.Name, ignore.case = TRUE)) %>% select(SCC)
library("dplyr")
library(ggplot2)
vehicle_sources <- SCC %>% filter(grepl("vehicle", Short.Name, ignore.case = TRUE)) %>% select(SCC)
## Add  filter(fips == "24510") or simplify
q5_result <- NEI %>% filter(SCC %in% coal_sources$SCC) %>% group_by(year) %>% summarize(Emissions = sum(Emissions))
# Create the plot
ggplot(q5_result, aes(x = year, y = Emissions)) +
geom_line() +
geom_point() +
labs(title = "Vehicle Emissions Over Time",
x = "Year",
y = "Total Emissions") +
theme_minimal()
library("dplyr")
library(ggplot2)
vehicle_sources <- SCC %>% filter(grepl("vehicle", Short.Name, ignore.case = TRUE)) %>% select(SCC)
## Add  filter(fips == "24510") or simplify
q5_result <- NEI %>% filter(SCC %in% coal_sources$SCC) %>% group_by(year) %>% summarize(Emissions = sum(Emissions))
# Create the plot
ggplot(q5_result, aes(x = year, y = Emissions)) +
geom_line() +
geom_point() +
labs(title = "Vehicle Emissions Over Time",
x = "Year",
y = "Total Emissions") +
theme_minimal()
vehicle_sources <- SCC %>%
filter(grepl("vehicle", Short.Name, ignore.case = TRUE)) %>%
select(SCC)
## Add  filter(fips == "24510") or simplify
q5_result <- NEI %>%
filter(SCC %in% coal_sources$SCC) %>%
group_by(year) %>% summarize(Emissions = sum(Emissions))
vehicle_sources <- SCC %>%
filter(grepl("vehicle", Short.Name, ignore.case = TRUE)) %>%
select(SCC)
## Add  filter(fips == "24510") or simplify
q5_result <- NEI %>%
filter(SCC %in% coal_sources$SCC) %>%
group_by(year) %>% summarize(Emissions = sum(Emissions))
ggplot(q5_result, aes(x = year, y = Emissions)) +
geom_line() +
geom_point() +
labs(title = "Vehicle Emissions Over Time",
x = "Year",
y = "Total Emissions") +
theme_minimal()
vehicle_sources <- SCC %>%
filter(grepl("vehicle", Short.Name, ignore.case = TRUE)) %>%
select(SCC)
## Add  filter(fips == "24510") or simplify
q5_result <- NEI %>%
filter(SCC %in% coal_sources$SCC) %>%
group_by(year) %>% summarize(Emissions = sum(Emissions))
vehicle_sources <- SCC %>%
filter(grepl("vehicle", Short.Name, ignore.case = TRUE)) %>%
select(SCC)
q5_result <- NEI %>%
filter(SCC %in% coal_sources$SCC & fips == "24510") %>%
group_by(year) %>% summarize(Emissions = sum(Emissions))
vehicle_sources <- SCC %>%
filter(grepl("vehicle", Short.Name, ignore.case = TRUE)) %>%
select(SCC)
q5_result <- NEI %>%
filter(SCC %in% vehicle_sources$SCC & fips == "24510") %>%
group_by(year) %>% summarize(Emissions = sum(Emissions))
coal_sources <- SCC %>%
filter(grepl("coal", Short.Name, ignore.case = TRUE)) %>%
q4_result <- NEI %>%
filter(SCC %in% coal_sources$SCC) %>%
group_by(year) %>%
summarize(Emissions = sum(Emissions))
vehicle_sources <- SCC %>%
filter(grepl("vehicle", Short.Name, ignore.case = TRUE))
q5_result <- NEI %>%
filter(SCC %in% vehicle_sources$SCC & fips == "24510") %>%
group_by(year) %>%
summarize(Emissions = sum(Emissions))
coal_sources <- SCC %>%
filter(grepl("coal", Short.Name, ignore.case = TRUE))
q4_result <- NEI %>%
filter(SCC %in% coal_sources$SCC) %>%
group_by(year) %>%
summarize(Emissions = sum(Emissions))
gc()
q1_result <- NEI %>%
group_by(year) %>%
summarize(Emissions = sum(Emissions))
plot(q1_result$year, q1_result$Emissions,
type = "b",
main = "Total PM2.5 Emissions by Year",
xlab = "Year",
ylab = "Total PM2.5 Emissions")
axis(side = 1, at = q1_result$year, labels = q1_result$year)
q1_result <- NEI %>%
group_by(year) %>%
summarize(Emissions = sum(Emissions))
plot(q1_result$year, q1_result$Emissions,
type = "b",
main = "Total PM2.5 Emissions by Year",
xlab = "Year",
ylab = "Total PM2.5 Emissions",
xaxt = "n")
axis(side = 1, at = q1_result$year, labels = q1_result$year)
q2_result <- NEI %>%
filter(fips == "24510") %>%
group_by(year) %>%
summarize(Emissions = sum(Emissions))
plot(q2_result$year, q2_result$Emissions,
type = "b",
main = "Total PM2.5 Emissions in Baltimore by Year",
xlab = "Year",
ylab = "Total PM2.5 Emissions in Baltimore",
xaxt = "n")
axis(side = 1, at = q1_result$year, labels = q1_result$year)
coal_sources <- SCC %>%
filter(grepl("coal", Short.Name, ignore.case = TRUE))
q4_result <- NEI %>%
filter(SCC %in% coal_sources$SCC) %>%
group_by(year) %>%
summarize(Emissions = sum(Emissions))
plot(q4_result$year, q4_result$Emissions,
type = "b",
main = "Total PM2.5 Emissions caused by coal by Year",
xlab = "Year",
ylab = "Total PM2.5 Emissions",
xaxt = "n")
axis(side = 1, at = q4_result$year, labels = q4_result$year)
coal_sources <- SCC %>%
filter(grepl("coal", Short.Name, ignore.case = TRUE))
q4_result <- NEI %>%
filter(SCC %in% coal_sources$SCC) %>%
group_by(year) %>%
summarize(Emissions = sum(Emissions))
plot(q4_result$year, q4_result$Emissions,
type = "b",
main = "Total PM2.5 Emissions caused by coal burning by Year",
xlab = "Year",
ylab = "Total PM2.5 Emissions",
xaxt = "n")
axis(side = 1, at = q4_result$year, labels = q4_result$year)
vehicle_sources <- SCC %>%
filter(grepl("vehicle", Short.Name, ignore.case = TRUE))
q5_result <- NEI %>%
filter(SCC %in% vehicle_sources$SCC & fips == "24510") %>%
group_by(year) %>%
summarize(Emissions = sum(Emissions))
plot(q5_result$year, q5_result$Emissions,
type = "b",
main = "Total PM2.5 Emissions caused by vehicles in Baltimore by Year",
xlab = "Year",
ylab = "Total PM2.5 Emissions",
xaxt = "n")
axis(side = 1, at = q5_result$year, labels = q5_result$year)
View(q3_result)
View(NEI)
View(q3_result)
q3_result <- NEI %>%
filter(fips == "24510") %>%
group_by(year, type) %>%
summarize(Emissions = sum(Emissions))
emission_types <- split(q3_result, q3_result$type)
par(mfrow = c(2, 2))
# Create plots for each type
lapply(emission_types, function(df) {
plot(df$year, df$Emissions, type = "b",
main = paste("PM2.5 Emissions by Year for", unique(df$type)),
xlab = "Year", ylab = "Total PM2.5 Emissions")
})
q3_result <- NEI %>%
filter(fips == "24510") %>%
group_by(year, type) %>%
summarize(Emissions = sum(Emissions))
q3_result <- NEI %>%
filter(fips == "24510") %>%
group_by(year, type) %>%
summarize(Emissions = sum(Emissions), .groups = "drop")
View(q3_result)
library("dplyr")
library("lattice")
q3_result <- NEI %>%
filter(fips == "24510") %>%
group_by(year, type) %>%
summarize(Emissions = sum(Emissions), .groups = "drop")
panel_function <- function(x, y, ...) {
panel.xyplot(x, y, type = "b", ...)
}
xyplot(Emissions ~ year | type, data = q3_result, layout = c(2, 2),
scales = list(y = list(relation = "free")),
panel = panel_function,
xlab = "Year", ylab = "Total PM2.5 Emissions",
main = "PM2.5 Emissions by Year and Type")
q3_result <- NEI %>%
filter(fips == "24510") %>%
group_by(year, type) %>%
summarize(Emissions = sum(Emissions), .groups = "drop")
panel_function <- function(x, y, ...) {
panel.xyplot(x, y, type = "b", ...)
}
xyplot(Emissions ~ year | type, data = q3_result, layout = c(4, 1),
scales = list(y = list(relation = "free")),
panel = panel_function,
xlab = "Year", ylab = "Total PM2.5 Emissions",
main = "PM2.5 Emissions by Year and Type")
q3_result <- NEI %>%
filter(fips == "24510") %>%
group_by(year, type) %>%
summarize(Emissions = sum(Emissions), .groups = "drop")
panel_function <- function(x, y, ...) {
panel.xyplot(x, y, type = "b", ...)
}
xyplot(Emissions ~ year | type, data = q3_result, layout = c(4, 1),
scales = list(y = list(relation = "same")),
panel = panel_function,
xlab = "Year", ylab = "Total PM2.5 Emissions",
main = "PM2.5 Emissions by Year and Type")
q3_result <- NEI %>%
filter(fips == "24510") %>%
group_by(year, type) %>%
summarize(Emissions = sum(Emissions), .groups = "drop")
panel_function <- function(x, y, ...) {
panel.xyplot(x, y, type = "b", ...)
}
xyplot(Emissions ~ year | type, data = q3_result, layout = c(4, 1),
scales = list(x = unique(q3_result$year), y = list(relation = "same")),
panel = panel_function,
xlab = "Year", ylab = "Total PM2.5 Emissions",
main = "PM2.5 Emissions by Year and Type")
q3_result <- NEI %>%
filter(fips == "24510") %>%
group_by(year, type) %>%
summarize(Emissions = sum(Emissions), .groups = "drop")
panel_function <- function(x, y, ...) {
panel.xyplot(x, y, type = "b", ...)
}
xyplot(Emissions ~ year | type, data = q3_result, layout = c(4, 1),
scales = list(x = list(at = unique(q3_result$year)), y = list(relation = "same")),
panel = panel_function,
xlab = "Year", ylab = "Total PM2.5 Emissions",
main = "PM2.5 Emissions by Year and Type")
vehicle_sources <- SCC %>%
filter(grepl("vehicle", Short.Name, ignore.case = TRUE))
q5_result <- NEI %>%
filter(SCC %in% vehicle_sources$SCC & (fips == "24510" | fips == "06037")) %>%
group_by(year, fips) %>%
summarize(Emissions = sum(Emissions), .groups = "drop")
vehicle_sources <- SCC %>%
filter(grepl("vehicle", Short.Name, ignore.case = TRUE))
q5_result <- NEI %>%
filter(SCC %in% vehicle_sources$SCC & (fips == "24510" | fips == "06037")) %>%
group_by(year, fips) %>%
summarize(Emissions = sum(Emissions), .groups = "keep")
vehicle_sources <- SCC %>%
filter(grepl("vehicle", Short.Name, ignore.case = TRUE))
q5_result <- NEI %>%
filter(SCC %in% vehicle_sources$SCC & (fips == "24510" | fips == "06037")) %>%
group_by(year, fips) %>%
summarize(Emissions = sum(Emissions), .groups = "drop")
unique_years <- unique(q5_result$year)
# Create lattice plot with panel plots for each fips
xyplot(Emissions ~ year | fips, data = q5_result, layout = c(2, 1),
scales = list(x = list(at = unique_years)),  # Customize x-axis ticks
panel = panel_function,
xlab = "Year", ylab = "Total PM2.5 Emissions",
main = "PM2.5 Emissions by Year and City")
vehicle_sources <- SCC %>%
filter(grepl("vehicle", Short.Name, ignore.case = TRUE))
q5_result <- NEI %>%
filter(SCC %in% vehicle_sources$SCC & (fips == "24510" | fips == "06037")) %>%
group_by(year, fips) %>%
summarize(Emissions = sum(Emissions), .groups = "keep")
unique_years <- unique(q5_result$year)
# Create lattice plot with panel plots for each fips
xyplot(Emissions ~ year | fips, data = q5_result, layout = c(2, 1),
scales = list(x = list(at = unique_years)),  # Customize x-axis ticks
panel = panel_function,
xlab = "Year", ylab = "Total PM2.5 Emissions",
main = "PM2.5 Emissions by Year and City")
vehicle_sources <- SCC %>%
filter(grepl("vehicle", Short.Name, ignore.case = TRUE))
q5_result <- NEI %>%
filter(SCC %in% vehicle_sources$SCC & (fips == "24510" | fips == "06037")) %>%
group_by(year, fips) %>%
summarize(Emissions = sum(Emissions), .groups = "drop")
unique_years <- unique(q5_result$year)
# Create lattice plot with panel plots for each fips
xyplot(Emissions ~ year | fips, data = q5_result, layout = c(2, 1),
scales = list(x = list(at = unique_years)),  # Customize x-axis ticks
panel = panel_function,
xlab = "Year", ylab = "Total PM2.5 Emissions",
main = "PM2.5 Emissions by Year and City")
vehicle_sources <- SCC %>%
filter(grepl("vehicle", Short.Name, ignore.case = TRUE))
q5_result <- NEI %>%
filter(SCC %in% vehicle_sources$SCC & (fips == "24510" | fips == "06037")) %>%
group_by(year, fips) %>%
summarize(Emissions = sum(Emissions), .groups = "drop")
# Define panel function to create individual panels for each fips
panel_function <- function(x, y, ...) {
panel.xyplot(x, y, type = "b", ...)
# Replace fips values with city names on the plot
panel.text(max(x), max(y), labels = ifelse(unique(q5_result$fips) == "24510", "Baltimore", "Los Angeles"), adj = c(1, -1))
}
unique_years <- unique(q5_result$year)
# Create lattice plot with panel plots for each fips
xyplot(Emissions ~ year | fips, data = q5_result, layout = c(2, 1),
scales = list(x = list(at = unique_years)),  # Customize x-axis ticks
panel = panel_function,
xlab = "Year", ylab = "Total PM2.5 Emissions",
main = "PM2.5 Emissions by Year and City")
vehicle_sources <- SCC %>%
filter(grepl("vehicle", Short.Name, ignore.case = TRUE))
q5_result <- NEI %>%
filter(SCC %in% vehicle_sources$SCC & (fips == "24510" | fips == "06037")) %>%
group_by(year, fips) %>%
summarize(Emissions = sum(Emissions), .groups = "drop")
unique_years <- unique(q5_result$year)
# Create lattice plot with panel plots for each fips
xyplot(Emissions ~ year | fips, data = q5_result, layout = c(2, 1),
scales = list(x = list(at = unique_years)),  # Customize x-axis ticks
panel = panel_function,
xlab = "Year", ylab = "Total PM2.5 Emissions",
main = "PM2.5 Emissions by Year and City")
q3_result <- NEI %>%
filter(fips == "24510") %>%
group_by(year, type) %>%
summarize(Emissions = sum(Emissions), .groups = "drop")
panel_function <- function(x, y, ...) {
panel.xyplot(x, y, type = "b", ...)
}
xyplot(Emissions ~ year | type, data = q3_result, layout = c(4, 1),
scales = list(x = list(at = unique(q3_result$year)), y = list(relation = "same")),
panel = panel_function,
xlab = "Year", ylab = "Total PM2.5 Emissions",
main = "PM2.5 Emissions by Year and Type")
vehicle_sources <- SCC %>%
filter(grepl("vehicle", Short.Name, ignore.case = TRUE))
q5_result <- NEI %>%
filter(SCC %in% vehicle_sources$SCC & (fips == "24510" | fips == "06037")) %>%
group_by(year, fips) %>%
summarize(Emissions = sum(Emissions), .groups = "drop")
unique_years <- unique(q5_result$year)
# Create lattice plot with panel plots for each fips
xyplot(Emissions ~ year | fips, data = q5_result, layout = c(2, 1),
scales = list(x = list(at = unique_years)),  # Customize x-axis ticks
panel = panel_function,
xlab = "Year", ylab = "Total PM2.5 Emissions",
main = "PM2.5 Emissions by Year and City")
vehicle_sources <- SCC %>%
filter(grepl("vehicle", Short.Name, ignore.case = TRUE))
q6_result <- NEI %>%
filter(SCC %in% vehicle_sources$SCC & (fips == "24510" | fips == "06037")) %>%
group_by(year, fips) %>%
summarize(Emissions = sum(Emissions), .groups = "drop")
unique_years <- unique(q6_result$year)
# Create lattice plot with panel plots for each fips
xyplot(Emissions ~ year | fips, data = q6_result, layout = c(2, 1),
scales = list(x = list(at = unique_years)),  # Customize x-axis ticks
panel = panel_function,
xlab = "Year", ylab = "Total PM2.5 Emissions",
main = "PM2.5 Emissions by Year and City")
View(q6_result)
vehicle_sources <- SCC %>%
filter(grepl("vehicle", Short.Name, ignore.case = TRUE))
q6_result <- NEI %>%
filter(SCC %in% vehicle_sources$SCC & (fips == "24510" | fips == "06037")) %>%
group_by(year, fips) %>%
summarize(Emissions = sum(Emissions), .groups = "drop")
panel_function <- function(x, y, ...) {
panel.xyplot(x, y, type = "b", ...)
panel.text(labels = ifelse(unique(q5_result$fips) == "24510", "Baltimore", "Los Angeles"))
}
unique_years <- unique(q6_result$year)
# Create lattice plot with panel plots for each fips
xyplot(Emissions ~ year | fips, data = q6_result, layout = c(2, 1),
scales = list(x = list(at = unique_years)),  # Customize x-axis ticks
panel = panel_function,
xlab = "Year", ylab = "Total PM2.5 Emissions",
main = "PM2.5 Emissions by Year and City")
vehicle_sources <- SCC %>%
filter(grepl("vehicle", Short.Name, ignore.case = TRUE))
q6_result <- NEI %>%
filter(SCC %in% vehicle_sources$SCC & (fips == "24510" | fips == "06037")) %>%
group_by(year, fips) %>%
summarize(Emissions = sum(Emissions), .groups = "drop")
panel_function <- function(x, y, ...) {
panel.xyplot(x, y, type = "b", ...)
panel.text(max(x), max(y), labels = as.character(substitute(city)), adj = c(1, -1))
}
unique_years <- unique(q6_result$year)
# Create lattice plot with panel plots for each fips
xyplot(Emissions ~ year | fips, data = q6_result, layout = c(2, 1),
scales = list(x = list(at = unique_years)),  # Customize x-axis ticks
panel = panel_function,
xlab = "Year", ylab = "Total PM2.5 Emissions",
main = "PM2.5 Emissions by Year and City",
city = c(Baltimore = "24510", Los_Angeles = "06037"))
vehicle_sources <- SCC %>%
filter(grepl("vehicle", Short.Name, ignore.case = TRUE))
q6_result <- NEI %>%
filter(SCC %in% vehicle_sources$SCC & (fips == "24510" | fips == "06037")) %>%
group_by(year, fips) %>%
summarize(Emissions = sum(Emissions), .groups = "drop")
unique_years <- unique(q6_result$year)
# Create lattice plot with panel plots for each fips
xyplot(Emissions ~ year | fips, data = q6_result, layout = c(2, 1),
scales = list(x = list(at = unique_years)),  # Customize x-axis ticks
panel = panel_function,
xlab = "Year", ylab = "Total PM2.5 Emissions",
main = "PM2.5 Emissions by Year and City")
vehicle_sources <- SCC %>%
filter(grepl("vehicle", Short.Name, ignore.case = TRUE))
q6_result <- NEI %>%
filter(SCC %in% vehicle_sources$SCC & (fips == "24510" | fips == "06037")) %>%
group_by(year, fips) %>%
summarize(Emissions = sum(Emissions), .groups = "drop")
unique_years <- unique(q6_result$year)
panel_function <- function(x, y, ...) {
panel.xyplot(x, y, type = "b", ...)
}
# Create lattice plot with panel plots for each fips
xyplot(Emissions ~ year | fips, data = q6_result, layout = c(2, 1),
scales = list(x = list(at = unique_years)),  # Customize x-axis ticks
panel = panel_function,
xlab = "Year", ylab = "Total PM2.5 Emissions",
main = "PM2.5 Emissions by Year and City")
