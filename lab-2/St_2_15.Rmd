---
title: "Лабораторна робота 2. Дослідницький аналіз даних"
author: "Команда №15"
output: html_notebook
---

```{r}
library("dplyr")
```

```{r}
NEI <- readRDS("summarySCC_PM25.rds")
SCC <- readRDS("Source_Classification_Code.rds")
```

```{r}
q1_result <- NEI %>%
  group_by(year) %>%
  summarize(Emissions = sum(Emissions))

plot(q1_result$year, q1_result$Emissions, 
     type = "b", 
     main = "Total PM2.5 Emissions by Year",
     xlab = "Year", 
     ylab = "Total PM2.5 Emissions",
     xaxt = "n")

axis(side = 1, at = q1_result$year, labels = q1_result$year)
```

```{r}
q2_result <- NEI %>%
  filter(fips == "24510") %>%
  group_by(year) %>%
  summarize(Emissions = sum(Emissions))

plot(q2_result$year, q2_result$Emissions, 
     type = "b", 
     main = "Total PM2.5 Emissions in Baltimore by Year",
     xlab = "Year", 
     ylab = "Total PM2.5 Emissions in Baltimore",
     xaxt = "n")

axis(side = 1, at = q2_result$year, labels = q2_result$year)
```

```{r}
q3_result <- NEI %>%
  filter(fips == "24510") %>% 
  group_by(year, type) %>% 
  summarize(Emissions = sum(Emissions))
```

```{r}
coal_sources <- SCC %>% 
  filter(grepl("coal", Short.Name, ignore.case = TRUE))

q4_result <- NEI %>% 
  filter(SCC %in% coal_sources$SCC) %>%
  group_by(year) %>%
  summarize(Emissions = sum(Emissions))

plot(q4_result$year, q4_result$Emissions, 
     type = "b", 
     main = "Total PM2.5 Emissions caused by coal burning by Year",
     xlab = "Year", 
     ylab = "Total PM2.5 Emissions",
     xaxt = "n")

axis(side = 1, at = q4_result$year, labels = q4_result$year)
```

```{r}
vehicle_sources <- SCC %>% 
  filter(grepl("vehicle", Short.Name, ignore.case = TRUE))

q5_result <- NEI %>% 
  filter(SCC %in% vehicle_sources$SCC & fips == "24510") %>% 
  group_by(year) %>% 
  summarize(Emissions = sum(Emissions))

plot(q5_result$year, q5_result$Emissions, 
     type = "b", 
     main = "Total PM2.5 Emissions caused by vehicles in Baltimore by Year",
     xlab = "Year", 
     ylab = "Total PM2.5 Emissions",
     xaxt = "n")

axis(side = 1, at = q5_result$year, labels = q5_result$year)
```

```{r}
## Two plots simmilar to 5 and 3
```